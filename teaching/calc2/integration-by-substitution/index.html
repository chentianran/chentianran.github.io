---
layout: ilecture2
title: Integration by substitution
---

<section class="titlepage">
    <div class="titlebox">
        <h2 class="title">Integration by substitution</h2>
        <p class="small">
            Chain rule in reverse
        </p>
    </div>
    <p>
        As the very first "advanced" integration technique we will study,
        integration by substitution is essentially the integral version of the "Chain Rule".
    </p>
    <!-- <p>Tianran Chen</p> -->
    <!-- <p class="footnote2"> -->
        <!-- Department of Mathematics<br> -->
        <!-- Auburn University at Montgomery -->
    <!-- </p> -->
</section>
<!-- <section data-audio-src="1-1.mp3"> </section> -->
<section>
    <h3>Integration by substitution</h3>
    <p>
        Integration by substitution is essentially the integral version of the "chain rule".
    </p>
    <p>
        It will allow us to compute seemingly complicated integrals like these
        \[
            \int e^{x^2} \, 2x \, dx,
            \quad\quad\quad
            \int \frac{3x}{\sqrt{x^2+1}} dx,
        \]
    </p>
</section>
<section>
    <h3>Preparation</h3>
    <div class="cols">
        <div class="col">
            <p>Hopefully, now you feel comfortable with basic integrals such as</p>
            <ul>
                <li>
                    $\int e^x dx = e^x + C$
                </li>
                <li>
                    $\int \cos(x) dx = \sin(x) + C$
                </li>
                <li>
                    $\int \sin(x) dx = -\cos(x) + C$
                </li>
                <li>
                    $\int 2x dx = x^2 + C$
                </li>
                <li>
                    $\int x^{-1} dx = \ln|x| + C$
                </li>
            </ul>
            <p>
                and you understand what they mean.
            </p>
        </div>
        <div class="col fragment">
            <p>
                Moreover, you understand that the names of the variables are 
                not very important in the sense that they only tell us 
                how to distinguish one from another, and nothing more. 
                E.g., you should be able to compute 
                \[
                    \int e^u du = e^u + C.
                \]
            </p>
        </div>
    </div>
    <p class="fragment">
        Make sure you also understand why we cannot directly compute 
        \[
            \int e^{\color{red} u} \, d{\color{red} x}.
        \]
    </p>
</section>
<section>
    <h3>Differentials</h3>
    <p>
        You also need to feel comfortable manipulating <em class="highlight">differentials</em>
        (which are objects like "$dx$" in integrals). 
    </p>
    <div class="cols">
        <div class="col">
            <p class="fragment">
                Suppose $u$ is a function of $x$, then 
                \[
                    du = \frac{du}{dx} \, dx.
                \]
                $du$ and $dx$ are called <b class="term">differentials</b>,
                and they are meaningful objects in their own rights, even outside integrals.
            </p>
        </div>
        <div class="col">
            <p class="fragment">
                For example, if $u$ is a function of $x$ given by
                \[
                    u = x^2
                \]
                then
                \[
                    du = 2x \, dx.
                \]
                It is important to understand $du$ is a function of both
                $x$ and $dx$.
            </p>
        </div>
    </div>
</section>
<section>
    <h3>Warm up exercises</h3>
    
    <p>
        You understand $\int e^x dx = e^x + C$ by now. 
        But what about something like 
        \[
            \int e^{3x} dx?
        \]
    </p>
    <p class="fragment">
        A naive guess would be $e^{3x} + C$.
        That’s not a terrible guess, but it is easy to see it is <em>wrong</em>,
        since the derivative of $e^{3x} + C$ would be $3e^{3x}$
        <span class="lowlight">(not $e^{3x}$)</span>.
    </p>
    <p class="fragment">
        So it is off by a factor of 3.
        To compensate for this, we simply need to multiply our original guess by $\frac{1}{3}$.
        Therefore, $\frac{1}{3} e^{3x} + C$ is our answer, i.e., 
        \[
            \int e^{3x} dx = \frac{1}{3} e^{3x} + C.
        \]
    </p>
    <div class="cols">
        <div class="col">
            <p class="fragment lowlight small">
                Side note: Here, we took an educated guess (which turns out to be wrong),
                and then we checked our answer and made a good correction.
                This is a completely valid tactic.
            </p>
        </div>
        <div class="col">
            <div class="problem fragment">
                Compute
                \[
                    \int \cos(10 x) dx.
                \]
            </div>
        </div>
    </div>
</section>
<section>
    <h3>Substitution</h3>

    <p>
        "Substitution" is the simple idea of replacing
        certain part of an expression by a single variable
        (or vice versa).
        For example,
        \[
            e^{-3x}
            \quad\text{is equivalent to}\quad
            e^u
            \;\text{ with }\;
            u = -3x.
        \]
        This simple idea allows us to compute more complicated integrals.
    </p>
    <p class="fragment">
        From the "chain rule" in differentiation, we know that
        \[
            [ f(g(x)) ]' = f'(g(x)) \, g'(x).
        \]
    </p>
    <p class="fragment">
        From this, we can easily derive the antiderivative/integral version.
    </p>
    <div class="cols">
        <div class="col fragment">
            <div class="theorem">
                Suppose $f$ is a continuous function
                and $g$ is a differentiable function,
                then with $u = g(x)$,
                \[
                    \int f(g(x)) \, g'(x) \, dx = \int f(u) du.
                \]
            </div>
        </div>
        <div class="col fragment">
            We are performing a substitution $u = g(x)$,
            i.e., replacing an inner function by a new variable $u$.
            The name is not important, 
            as long as it is different from the original variable of integration.
        </div>
    </div>
</section>
<section>
    <!-- <h3>Examples</h3> -->
    <p>
        We will compute the following integrals using the fact that
        \[
            \int f(g(x)) \, g'(x) \, dx = \int f(u) du.
        \]
    </p>
    <div class="cols">
        <div class="col">
            <div class="example fragment">
                Compute
                \[
                    \int \cos(5x) \, 5 \, dx.
                \]
            </div>
            <p class="fragment small"><b>Solution.</b>
                The "inner" function is $u = g(x) = 5x$
                (so $g'(x) = 5$), and the "outer" function $f(x) = \cos(x)$.
                <span class="fragment">
                    Thus,
                    \begin{gather*}
                        \int \cos(5x) 5 dx 
                        = \int f(g(x)) g'(x) dx \\
                        = \int f(u) du  = \int \cos(u) du \\
                        = \sin(u) + C = \sin(5x) + C.
                    \end{gather*}
                </span>
            </p>
        </div>
        <div class="col">
            <div class="example fragment">
                Compute
                \[
                    \int e^{x^2} \, 2x \, dx.
                \]
            </div>
            <p class="fragment small"><b>Solution.</b>
                The "inner" function is $u = g(x) = x^2$
                (so $g'(x) = 2x$), and the "outer" function $f(x) = e^x$.
                <span class="fragment">
                    Thus,
                    \begin{gather*}
                        \int e^{x^2} 2x dx.
                        = \int f(g(x)) g'(x) dx \\
                        = \int f(u) du  = \int e^u du \\
                        = e^u + C = e^{x^2} + C.
                    \end{gather*}
                </span>
            </p>

        </div>
    </div>
</section>
<section>
    <h3>Substitution in action: a more natural way of writing</h3>
    <div class="cols">
        <div class="col">
            <div class="example">
                Compute
                \[ \int \cos( \, 3x \,) dx \]
            </div>
        </div>
        <div class="col fragment">
            <b>Solution.</b>
            We will now follow a more natural way writing.
            <p class="fragment">
                Let $u = 3x$ (the "inner" function")
                <span class="fragment">then $du = \frac{du}{dx} \, dx = 3x \, dx.$</span>
            </p>
        </div>
    </div>
    <p class="fragment">
        That is, $ \color{blue}{\frac{1}{3} du = dx}$.
        <span class="fragment">
            Now we can replace $\color{red}{3x}$ by $\color{red}{u}$
            and replace $\color{blue}{dx}$ by $\color{blue}{\frac{1}{3} du}$:
            \begin{align*}
                \int \cos(\color{red}{3x}) \,\color{blue}{dx}
                &= \int \cos(\color{red}{u}) \,\color{blue}{\frac{1}{3} du}
                = \frac{1}{3} \int \cos(u) du
                = \frac{\sin(u)}{3} + C
            \end{align*}
            where $C$ is an arbitrary constant.
        </span>
        <span class="fragment">
            Don’t forget that $u$ is a variable we introduced ourselves.
            So we have to substitute everything back and get 
            \[
                \frac{\sin(u)}{3} + C
                = \frac{\sin(3x)}{3} + C.
            \]
        </span>
    </p>
</section>
<section>
    <h3>One more example</h3>
    <div class="cols">
        <div class="col">
            <div class="example">
                Compute
                \[ \int x \sqrt{1 + x^2} dx \]
            </div>
        </div>
        <div class="col fragment">
            <b>Solution.</b>
            Let $u = 1+x^2$, 
            <span class="fragment">then, by definition, $du = 2x \, dx.$</span>
            <span class="fragment">
                That is, \[ \color{blue}{\frac{1}{2} du = x \, dx} \]
            </span>
        </div>
    </div>
    <p class="fragment">
        Now we can replace $\color{red}{1+x^2}$ by $\color{red}{u}$
        and replace $\color{blue}{x \, dx}$ by $\frac{1}{2} du$.
        <span class="fragment">
            Therefore,
            \begin{align*}
                \int \color{blue}{x} \sqrt{\color{red}{1+x^2} } \,\color{blue}{dx}
                &= \int \sqrt{\color{red}{u}} \,\color{blue}{\frac{1}{2} du}
                = \frac{1}{2} \int \sqrt{u} \, du
                = \frac{u^{3/2}}{3} + C
            \end{align*}
            where $C$ is an arbitrary constant.
        </span>
        <span class="fragment">
            Again, $u$ is a variable we introduced ourselves.
            So we have to substitute everything back and get 
            \[
                \frac{u^{3/2}}{3} + C
                = \frac{(1+x^2)^{3/2}}{3} + C
            \]
        </span>
    </p>
</section>
<section>
    <h3>Integration by substitution</h3>
    <p>
        The above procedure is the essence of 
        <em class="term">integration by substitution</em>. 
        Simply put, when faced with a complicated integral of the form $\int f(x) dx$,
    </p>
    <ol>
        <li class="fragment">Identify a part of the integral and replace it by a new variable;</li>
        <li class="fragment">Also properly replace the differential $dx$;</li>
        <li class="fragment">Compute the resulting simpler integral if possible;</li>
        <li class="fragment">Replace everything back.</li>
    </ol>
    <p class="fragment">
        This is the main idea.
        You will have to practice these on many problems to become proficient in this technique.
    </p>
    <div class="cols fragment">
        <div class="col">
            <div class="problem">
                Compute
                \[
                    \int (2x + 5)^6 dx.
                \]
                (Hint: try $u = 2x+5$.)
            </div>
        </div>
        <div class="col">
            <div class="problem">
                Compute \[\int \sin(x^3) x^2 \, dx.\]
                (Hint: try $u = x^3$.)
            </div>
        </div>
    </div>
<p></p>
<!-- <p>The choice for the substitution is less obvious now. Let <span class="math display">\[\begin{aligned}
            u &amp;= 3x^2 - 9
            &amp;&amp;\text{then} &amp;
            du &amp;= \frac{d}{dx} (3x^2 - 9) \, dx = 6x \, dx
            &amp;&amp;\text{i.e.,} &amp;
            x \, dx &amp;= \frac{1}{6} du.
        \end{aligned}\]</span> So we can now replace <span class="math inline">\(3x^2 - 9\)</span> by <span class="math inline">\(u\)</span> and replace <span class="math inline">\(x dx\)</span> by <span class="math inline">\(\frac{1}{6} du\)</span>, and we get <span class="math display">\[\int ({\color{red} 3x^2 - 9})^4 {\color{olive} x dx}
            = \int {\color{red} u}^4 \, {\color{olive} \frac{1}{6} du}
            = \frac{1}{6} \int u^4 \, du
            = \frac{1}{6} \cdot \frac{u^5}{5} + C_0
            = \frac{u^5}{30} + C,\]</span> where <span class="math inline">\(C\)</span> is an arbitrary constant. Don’t forget to substitute everything back: <span class="math display">\[\int (3x^2 - 9)^4 x dx.
            = \frac{u^5}{30} + C_0
            = \frac{(3x^2 - 9)^5}{30} + C.\]</span></p>
<p>Compute the indefinite integral <span class="math display">\[\int \cos(x^2) x dx.\]</span> (Hint: try the substitution <span class="math inline">\(u=x^2\)</span>)</p> -->
</section>
<section>
    <h3>A less obvious example</h3>
    <div class="cols">
        <div class="col example">
            Compute \[\int \tan(x) dx.\]
        </div>
        <div class="col">
            It is not at all obvious that we can even apply substitution here. 
            Let's first rewrite $\tan(x)$ in terms of $\sin(x)$ and $\cos(x)$: 
        </div>
    </div>
    <p class="fragment">
        \[
            \int \tan(x) dx
            = \int \frac{\sin(x)}{\cos(x)} dx
            = \int \frac{1}{\cos(x)} \, \sin(x) \, dx.
        \] 
    </p>
    <p class="fragment">
        Now we can pick $u = \cos(x)$.
        <span class="fragment">
            then $du = -\sin(x) dx$.
        </span>
        <span class="fragment">
            That is, 
            \[
                (-1) du = \sin(x) dx.
            \]
        </span>
        <span class="fragment">
            Therefore the above integral becomes
            \[
                \int \frac{1}{\cos(x)} \sin(x) dx
                = -\int \frac{1}{u} du
                = -\ln|u| + C
                = -\ln|\cos(x)| + C.
            \]
        </span>
    </p>
</section>
<section>
    <h3>When substitution doesn't work</h3>
    <p>
        It is very important to understand the limitation of your tools.
        Consider the integral
        \[
            \int e^{x^2} dx.
        \]
    </p>
    <p class="fragment">
        Can you see why the substitution $u = x^2$ will not work?
    </p>
</section>